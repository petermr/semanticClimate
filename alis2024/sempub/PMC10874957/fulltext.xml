<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmcid">10874957</article-id><article-id pub-id-type="pmid">38369571</article-id>
<article-id pub-id-type="publisher-id">54640</article-id><article-id pub-id-type="doi">10.1038/s41598-024-54640-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Transductive meta-learning with enhanced feature ensemble for few-shot semantic segmentation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Karimi</surname><given-names>Amin</given-names></name><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Poullis</surname><given-names>Charalambos</given-names></name><address><email>charalambos@poullis.org</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0420zvk78</institution-id><institution-id institution-id-type="GRID">grid.410319.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8630</institution-id><institution>Immersive and Creative Technologies Lab, Department of Computer Science and Software Engineering, </institution><institution>Concordia University, </institution></institution-wrap>Montreal, Canada </aff></contrib-group><pub-date pub-type="epub"><day>18</day><month>2</month><year>2024</year></pub-date><pub-date pub-type="pmc-release"><day>18</day><month>2</month><year>2024</year></pub-date><pub-date pub-type="collection"><year>2024</year></pub-date><volume>14</volume><elocation-id>4028</elocation-id><history><date date-type="received"><day>4</day><month>11</month><year>2023</year></date><date date-type="accepted"><day>14</day><month>2</month><year>2024</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2024</copyright-statement><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">This paper addresses few-shot semantic segmentation and proposes a novel transductive end-to-end method that overcomes three key problems affecting performance. First, we present a novel ensemble of visual features learned from pretrained classification and semantic segmentation networks with the same architecture. Our approach leverages the varying discriminative power of these networks, resulting in rich and diverse visual features that are more informative than a pretrained classification backbone that is not optimized for dense pixel-wise classification tasks used in most state-of-the-art methods. Secondly, the pretrained semantic segmentation network serves as a base class extractor, which effectively mitigates false positives that occur during inference time and are caused by base objects other than the object of interest. Thirdly, a two-step segmentation approach using transductive meta-learning is presented to address the episodes with poor similarity between the support and query images. The proposed transductive meta-learning method addresses the prediction by first learning the relationship between labeled and unlabeled data points with matching support foreground to query features (intra-class similarity) and then applying this knowledge to predict on the unlabeled query image (intra-object similarity), which simultaneously learns propagation and false positive suppression. To evaluate our method, we performed experiments on benchmark datasets, and the results demonstrate significant improvement with minimal trainable parameters of 2.98<italic>M</italic>. Specifically, using Resnet-101, we achieve state-of-the-art performance for both 1-shot and 5-shot Pascal-<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq1.gif"/></alternatives></inline-formula>, as well as for 1-shot and 5-shot COCO-<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq2.gif"/></alternatives></inline-formula>.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Computer science</kwd><kwd>Computational science</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>RGPIN-2021-03479</award-id><principal-award-recipient><name><surname>Poullis</surname><given-names>Charalambos</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Springer Nature Limited 2024</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Deep neural networks can learn rich information about visual features of classes that appear in images when trained on vast amounts of labeled data. These attributes significantly contributed to various critical applications, including medical applications<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>.However, their ability to generalize to new classes diminishes when presented with only a limited number of labeled examples<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, which is a prevalent issue in domains such as geospatial and medical, where collecting and labeling large datasets is a complex and expensive process. To overcome this issue, researchers have proposed the few-shot learning paradigm, which attempts to mimic the capacity of the human visual system to rapidly learn new classes from a small number of labeled examples.
</p><p id="Par3">This paper focuses on few-shot semantic segmentation, a special case of semantic segmentation in which the model must generalize to novel(unseen) classes and classify the pixels in an image. The most challenging aspect of few-shot segmentation is fully utilizing the information in the small support set of training examples <italic>K</italic> on <italic>N</italic> unseen classes (<italic>N</italic>-way, <italic>K</italic>-shot for <inline-formula id="IEq6"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K&#x0003c;5$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>K</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq6.gif"/></alternatives></inline-formula>). Two primary strategies for fewshot image understanding are proposed. The first strategy centers on the learning-to-learn (or meta-learning) paradigm. In order to simulate the tasks that will be presented during inference, meta-learning strategies popularized the necessity of organizing training data into episodes<sup><xref ref-type="bibr" rid="CR4">4</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref></sup>. Similar to standard training, the second line of research addresses few-shot image understanding by training a network using base classes and fine-tuning with novel classes<sup><xref ref-type="bibr" rid="CR17">17</xref>&#x02013;<xref ref-type="bibr" rid="CR24">24</xref></sup>. A frozen pretrained classification backbone is utilized by the both line of researches because it has been demonstrated to generalize more effectively to unseen classes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Figure 1</label><caption><p>We propose two-pass end-to-end method for few-shot semantic segmentation. The approach leverages an ensemble of visual features learned from pretrained classification <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq3.gif"/></alternatives></inline-formula> and semantic segmentation <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq4.gif"/></alternatives></inline-formula> networks with the same architecture. <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq5.gif"/></alternatives></inline-formula> is also used as a base class extractor. The first pass (red background) matches support foreground features to query features to address intra-class variation, and the second pass (green background) suppresses false positives and propagates query foreground features to leverage intra-object variation. Heatmaps show pixel-correlations between the query features and support foreground features in different layers of the network.</p></caption><graphic xlink:href="41598_2024_54640_Fig1_HTML" id="MO1"/></fig></p><p id="Par4">The first observation is that a pre-trained classification backbone on a large-scale dataset such as Image-Net contains rich semantic clues; however, it is suboptimal to adopt directly for a segmentation task<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Nevertheless, the majority of recent techniques have shown that fine-tuning a pre-trained classification backbone during the episodic training phase is susceptible to overfitting. Experiments presented in<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> to fine-tune the entire backbone or a subset of layers in FSS demonstrate a negative effect on the final result. Consequently, during the episodic phase, updating millions of backbone parameters necessitates careful training considerations and increases the demand for training resources and time. The recent work to address this issue<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, which achieves state-of-the-art with a Resnet-50, significantly increases the memory requirements compared to other few-shot techniques. The objective of updating the backbone is to provide enhanced pixel-level features, which is an open problem in FSS. To achieve enhanced pixel-level features without fine-tuning the backbone, we investigated the distinctions between a classification and segmentation backbone. Classification networks are trained with image-level labels and learn visual features that incorporate the spatial distribution and shape of the objects at a higher level of abstraction. In contrast, semantic segmentation networks trained on pixel-level labels discover visual features at the pixel-level that incorporate contextual information based on the spatial relationships between different objects in the image<sup><xref ref-type="bibr" rid="CR25">25</xref>&#x02013;<xref ref-type="bibr" rid="CR28">28</xref></sup>. In other words, the discriminative power of a semantic segmentation network is higher at intermediate layers, while a classification network has a higher discriminative power at the final layers. We present the experiments and analysis on the impact that a pretrained backbone can have on the pixel-wise feature correlations, when it is pretrained on a classification versus a semantic segmentation task. For the comparison, we used a frozen classification backbone pretrained on ImageNet-1K and a frozen semantic segmentation backbone pretrained on base classes as described in<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. We analyzed the pixel-correlations between the query features and support foreground features by calculating the discriminative power of the features at each backbone layer. The discriminative power <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k}$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq7.gif"/></alternatives></inline-formula> at layer <italic>k</italic> is measured as the ratio <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k} = \frac{\frac{1}{N} \sum _{i}^{N} cos\left( FG_{Q}^{i},P_{S}\right) }{\frac{1}{M} \sum _{j}^{M} cos\left( BG_{Q}^{j},P_{S}\right) }$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq8.gif"/></alternatives></inline-formula> where <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{S}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq9.gif"/></alternatives></inline-formula> is the support prototype calculated by averaging all the foreground support features <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{S}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq10.gif"/></alternatives></inline-formula>. The numerator is the average cosine distance of the <italic>N</italic> foreground query features <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{Q}^{i}, 0 \le i \le N$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq11.gif"/></alternatives></inline-formula> to the foreground support prototype <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{S}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq12.gif"/></alternatives></inline-formula>, and the denominator is the average cosine distance of the <italic>M</italic> background query features <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG_{Q}^{j}, 0 \le j \le M$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq13.gif"/></alternatives></inline-formula> to <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{S}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq14.gif"/></alternatives></inline-formula>. Intuitively, the higher the ratio <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k}$$\end{document}</tex-math><mml:math id="M30"><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq15.gif"/></alternatives></inline-formula> the higher the discriminative power to differentiate between the query foreground and background features w.r.t. the support foreground features at layer <italic>k</italic>. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a and b show the discriminative power calculated using more than 4&#x000a0;000 episodes from Pascal-<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq16.gif"/></alternatives></inline-formula>, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k}$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq17.gif"/></alternatives></inline-formula> of each backbone at layers <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k, 1 \le k \le |B_{cls}|$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq18.gif"/></alternatives></inline-formula> of the frozen pretrained backbones <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq20.gif"/></alternatives></inline-formula>. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>c top-left, shows the query image, with an inset of the corresponding support image. The remaining panels depict pixel-correlations between the query features and support foreground features in different layers (from left to right, intermediate layers to final layers) of a pretrained classification network (top row) and a semantic segmentation network (bottom row) which shows the higher discriminative power of the semantic segmentation network in the intermediate layers and similarly, for the classification network in the final layers. Utilizing the advantages of each, we present a multi-scale feature ensemble comprised of visual features learned by pretrained classification and semantic segmentation networks to specifically satisfy the need for both rich semantic cues and pixel-level information.<fig id="Fig2"><label>Figure 2</label><caption><p>Discriminative power of classification vs semantic segmentation networks. (<bold>a</bold>) <inline-graphic xlink:href="41598_2024_54640_Figa_HTML.gif" id="d32e588"/>: classification network (Resnet-50), <inline-graphic xlink:href="41598_2024_54640_Figb_HTML.gif" id="d32e591"/>: semantic segmentation network (Resnet-50). The discriminative power <inline-formula id="IEq31"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k}$$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq31.gif"/></alternatives></inline-formula> at layer <italic>k</italic> is measured as the ratio <inline-formula id="IEq32"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho ^{k} = \frac{\frac{1}{N} \sum _{i}^{N} cos\left( FG_{Q}^{i},P_{S}\right) }{\frac{1}{M} \sum _{j}^{M} cos\left( BG_{Q}^{j},P_{S}\right) }$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msup><mml:mi>&#x003c1;</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq32.gif"/></alternatives></inline-formula> (<bold>b</bold>) Same as (<bold>a</bold>) but for Resnet-101. Graphs for all folds are in the appendix. (<bold>c</bold>) The top left shows the query image, with an inset of the corresponding support image. The remaining panels depict pixel-correlations between the query features and support foreground features in different layers (from left to right, intermediate layers to final layers) of a pretrained classification (top row) and semantic segmentation networks (bottom row). The discriminative power of a semantic segmentation network is higher at intermediate layers, and the discriminative power of a classification network is higher at the final layers as also demonstrated in (<bold>a</bold>).</p></caption><graphic xlink:href="41598_2024_54640_Fig2_HTML" id="MO2"/></fig></p><p id="Par5">The second observation is that the object in the support image is frequently not visually similar to that in the query image. Several factors contribute to this, including viewpoint variation, illumination changes, scale, deformation, occlusion, intra-class variation, clutter, and motion. Consequently, query segmentation may contain some errors. Numerous techniques for self-refinement based on initial query prediction have been proposed<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. Recently<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, proposed a two-step segmentation method by utilizing the high confidence area of initial query prediction via non-differentiable thresholding, which has a number of limitations. In contrast, we present a two-pass end-to-end dense correlation learning method that enables the network to learn the visual disimilarities between the query foreground features and the false positives without introducing non-differentiable operations or additional components. In the first pass, intra-class similarity is addressed by matching support foreground features to query features, and in the second step, intra-object similarity is addressed by suppressing false positives from the initial prediction and propagating query foreground features throughout the query image. The proposed method does not introduce any additional trainable parameters to the network, whereas the<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> fine-tunes the last two blocks of a backbone. Moreover, our self-refinement module can operate on top of any backbone, which is another significant advantage over<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> which reshapes embedding space for self-refinement.</p><p id="Par6">The third observation is that false positives account for a substantial proportion of incorrect classifications and significantly hinder performance. As noted by<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, the presence of base classes in the background of the query image can lead to false positive predictions, as the network may incorrectly classify pixels that are not part of the object of interest. To address this issue, they proposed auxiliary layers on top of a base learner that is trained on base classes to predict whether or not each pixel in the output of the meta learner corresponds to a base class. By using this information to selectively mask out base class predictions, they were able to reduce the number of false positives and improve segmentation accuracy. Inspired by this work and based on observations from our extensive experimentation -as described in the appendix- we propose a method that reduces false positives caused by base classes that is both simpler and faster than the method proposed by<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, resulting in a shorter training time with the same functionality and performance.</p><p id="Par7">In this paper, we present a two-pass end to end method for few-shot semantic segmentation that addresses each of the aforementioned issues. The proposed method (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>) leverages an ensemble of visual features learned by segmentation and classification backbones to segment a query image in two steps. Dense convolutional layers trained to match support objects to query images using ensemble features in first step and propagate initial query predictions in the second step.</p><p id="Par8">We evaluate our method on the benchmark datasets Pascal-<inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq21.gif"/></alternatives></inline-formula> and COCO-<inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq22.gif"/></alternatives></inline-formula>, and report our results. On Pascal-<inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq23.gif"/></alternatives></inline-formula> 1-shot and 5-shot, with a Resnet-101 backbone, we achieve state-of-the-art by a margin of <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.51\%$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>2.51</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.12\%$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mn>1.12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq25.gif"/></alternatives></inline-formula>, respectively. Similarly, on COCO-<inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M56"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq26.gif"/></alternatives></inline-formula> 1-shot and 5-shot, with a Resnet-101 backbone, we achieve state-of-the-art by a margin of <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.98\%$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mn>3.98</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6\%$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq28.gif"/></alternatives></inline-formula>, respectively. Our model has a minimal number of trainable parameters i.e. 2,&#x000a0;980,&#x000a0;711 compared to the baseline<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> i.e. 2,&#x000a0;587,&#x000a0;394.</p><p id="Par9">The paper is organized as follows: Section&#x000a0;&#x0201c;<xref rid="Sec2" ref-type="sec">Related work</xref>&#x0201d; outlines the most recent and pertinent work in few-shot semantic segmentation. In Section&#x000a0;&#x0201c;<xref rid="Sec3" ref-type="sec">Methodology</xref>&#x0201d;, the methodology is described in depth, followed by the experiments and ablations on the two benchmark datasets Pascal-<inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq29.gif"/></alternatives></inline-formula> and COCO-<inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M64"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq30.gif"/></alternatives></inline-formula> in Section&#x000a0;&#x0201c;<xref rid="Sec6" ref-type="sec">Experiments</xref>&#x0201d;. We conclude and provide suggestions for future work in Section&#x000a0;&#x0201c;<xref rid="Sec10" ref-type="sec">Conclusion</xref>&#x0201d;.
</p></sec><sec id="Sec2"><title>Related work</title><p id="Par10">Few-shot learning techniques enable learners to generalize to new classes using a small number of labeled samples. These techniques follow a similar pipeline: a pre-trained backbone network is used to generate feature embeddings from input images, and a model head is used to generate segmentation maps using these embeddings as input. Numerous techniques have been proposed that fall into one of four broad categories: (i) metric learning techniques where the objective is to learn a mapping from image space to feature space that ensures the distance between feature vectors of similar categories is small, while it is large for dissimilar categories<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR30">30</xref>&#x02013;<xref ref-type="bibr" rid="CR33">33</xref></sup>, (ii) initialization-based techniques where the objective is to learn a good model initialization so that fine-tuning is possible with a few training examples and a small number of gradient update steps<sup><xref ref-type="bibr" rid="CR34">34</xref>&#x02013;<xref ref-type="bibr" rid="CR41">41</xref></sup>, (iii) Hallucination-based techniques where the objective is to learn a generator from the available data that &#x0201c;hallucinates&#x0201d; novel class data for data augmentation<sup><xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR43">43</xref></sup>, (iv) semantic-based learning techniques where the objective is to learn a generator conditioned on additional attributes, typically semantic word embeddings. Then, a layer for fine-tuning classification is applied to features from both types of classes<sup><xref ref-type="bibr" rid="CR44">44</xref>&#x02013;<xref ref-type="bibr" rid="CR46">46</xref></sup>.</p><p id="Par11">Our work falls into the metric-based techniques and is trained with episodic training as proposed by initialization-based approaches. Early work with metric-based approaches used a two branch network to find the most similar area in the query image using extracted support prototypes based on distance measures, such as Euclidean distance and cosine distance<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Other work proposed additional modules to compare query pixels and support prototypes<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, while others focused on the limited representation capability of a single prototype and proposed methods to develop multiple prototypes to perform comparisons<sup><xref ref-type="bibr" rid="CR13">13</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref></sup>.</p><p id="Par12">Recently<sup><xref ref-type="bibr" rid="CR17">17</xref>&#x02013;<xref ref-type="bibr" rid="CR21">21</xref></sup>, reevaluated the use of cross-entropy for training the network on base classes and demonstrated that competitive performance could be attained through fine-tuning on unseen classes. Following this pattern, works including<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup> demonstrated that transductive few-shot learning could enhance performance. Specifically<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, attained competitive performance by incorporating transductive loss terms into the training and then fine-tuning a single classifier layer trained on base classes. Shannon entropy<sup><xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup> on each query sample and KL divergence on background/foreground distribution of samples<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> are the two most common transductive losses. This research demonstrated that transductive learning could not generalize to a new class, however, it can learn the characteristics of a specific sample of a new category, substantially improving the final results.</p><p id="Par13">Currently, few-shot semantic segmentation techniques tend to use all available information and learn the visual similarities between the pixels in the query and support image. Particularly, all-pairs field transforms introduced by<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> for visual similarities contributed to further considerable gains in few-shot semantic segmentation. The authors of<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> recast few-shot semantic segmentation as a visual similarity task and perform <inline-formula id="IEq35"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^4$$\end{document}</tex-math><mml:math id="M66"><mml:msup><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq35.gif"/></alternatives></inline-formula> all-pairs visual comparisons between the pixel-level features in the query and support images. Instead of learning similarities between class prototypes, their network is trained on the visual similarities between all pixel pairings at various network layers.</p><p id="Par14">Several methods have recently shown a considerable performance improvement using pre-trained transformer backbone. Shi et al.<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> suggested a method for computing similarities between query pixels and all support pixels using a multi-level pixel-wise attention module. The authors reported a substantial improvement when employing a pre-trained transformer backbone as opposed to a convolutional backbone such as ResNet. Zhang et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> revives the framework of using a backbone for feature extraction followed by a linear classification head. The authors propose a transformer as the backbone and a classification head that combines pixel-level and class-level features, which has been shown to capture global context better than a convolutional network, significantly boosting performance. Recent works such as<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, have demonstrated significant gains in performance, however, this can easily be attributed to the vision transformer backbone rather than the effectiveness of their proposed technique.</p><p id="Par15">Despite these advancements, there are still challenges to overcome, most notably the bias towards the base classes and insufficient visual similarity between the support and query image, which can result in subpar performance. Our method alleviates these issues. Specifically, our technical contributions are as follows:<list list-type="bullet"><list-item><p id="Par16">An end-to-end transductive learning method for few-shot semantic segmentation. Uniquely, the matching operates on dense, multi-level visual similarities between support-query pixels and query-query pixels in the first and second passes, respectively.</p></list-item><list-item><p id="Par17">A feature ensemble comprised of visual features learned by pretrained classification and semantic segmentation networks. Furthermore, the semantic segmentation network, through the use of a simple and efficient pipeline, serves as a base class and background extractor, drastically reducing false positives, as shown in Table <xref rid="Tab1" ref-type="table">1</xref><table-wrap id="Tab1"><label>Table 1</label><caption><p>Results from our two-pass method. 1st pass: intra-class similarity (<inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\longrightarrow Q$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq33.gif"/></alternatives></inline-formula>). 2nd pass: intra-object similarity (<inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q\longrightarrow Q$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq34.gif"/></alternatives></inline-formula>).</p></caption><graphic position="anchor" xlink:href="41598_2024_54640_Tab1_HTML" id="MO3"/></table-wrap>.</p></list-item><list-item><p id="Par18">Our method, using Resnet-101 backbone, achieves state-of-the art performance on 1-shot and 5-shot Pascal-<inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq36.gif"/></alternatives></inline-formula> as well as COCO-<inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq37.gif"/></alternatives></inline-formula> while requiring only 2.98<italic>M</italic> in trainable parameters.</p></list-item></list></p></sec><sec id="Sec3"><title>Methodology</title><p id="Par19">The input is a pair of images of the same class <italic>S</italic> and <italic>Q</italic> which form the support and query respectively.</p><sec id="Sec4"><title>Learning intra-class similarity <inline-formula id="IEq45"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S \rightarrow Q$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq45.gif"/></alternatives></inline-formula></title><p id="Par20">The first pass takes the support <inline-formula id="IEq46"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}=S$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq46.gif"/></alternatives></inline-formula> and query <italic>Q</italic> as inputs. The objective of this pass is to learn intra-class similarity by learning features from the support <inline-formula id="IEq47"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq47.gif"/></alternatives></inline-formula> and segment visually similar features in the query <italic>Q</italic>.</p><p id="Par21">A backbone <inline-formula id="IEq48"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq48.gif"/></alternatives></inline-formula> is a frozen pretrained classification network that learns features <inline-formula id="IEq49"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{cls}$$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{Q}^{cls}$$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq50.gif"/></alternatives></inline-formula> for image <inline-formula id="IEq51"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq51.gif"/></alternatives></inline-formula> and <italic>Q</italic>, respectively. These features encode the spatial distribution and shape of the objects at a more abstract level. This information is supplemented by features <inline-formula id="IEq52"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{sem}$$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq52.gif"/></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{Q}^{sem}$$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq53.gif"/></alternatives></inline-formula> learned by a backbone <inline-formula id="IEq54"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq54.gif"/></alternatives></inline-formula>, a frozen semantic segmentation network trained on both background and base classes. The training of <inline-formula id="IEq55"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq55.gif"/></alternatives></inline-formula> with pixel-level labels results in features <inline-formula id="IEq56"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{sem}$$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{Q}^{sem}$$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq57.gif"/></alternatives></inline-formula> capturing contextual information and spatial similarities.</p><p id="Par22">Support features from the two backbones, <inline-formula id="IEq58"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{cls}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{sem}$$\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq59.gif"/></alternatives></inline-formula>, are multiplied by the foreground mask <inline-formula id="IEq60"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{S_{1}}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq60.gif"/></alternatives></inline-formula> in order to remove background-related features.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{S_{1}}^{cls}&#x00026;= FG_{S_{1}} \otimes B_{cls}(S_{1}), \, f_{Q}^{cls} = B_{cls}(Q) \end{aligned}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{S_{1}}^{sem}&#x00026;= FG_{S_{1}} \otimes B_{sem}(S_{1}), \, f_{Q}^{sem} = B_{sem}(Q) \end{aligned}$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Next, we compare the support and query features by computing the cosine similarity between all pairs of pixels in <inline-formula id="IEq61"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{1}}^{i}$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{Q}^{i}$$\end{document}</tex-math><mml:math id="M114"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq62.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq63"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{cls, sem\}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq63.gif"/></alternatives></inline-formula>. This is performed at different depths of each backbone leading to a set of multi-scale 4D volumes, each given by,<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} HV\left( f_{S}^{i}, \,f_{Q}^{i}\right) = \text {ReLU}\left( \frac{f_{S}^{i} \cdot f_{Q}^{i}}{\left| f_{S}^{i}\right| \cdot \left| f_{Q}^{i}\right| }\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M118" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mtext>ReLU</mml:mtext><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced><mml:mo>&#x000b7;</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{cls, sem\}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq64.gif"/></alternatives></inline-formula>. For features with dimensions in <inline-formula id="IEq65"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}^{C\times H\times W}$$\end{document}</tex-math><mml:math id="M122"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq65.gif"/></alternatives></inline-formula> the dimensions of the volume are <inline-formula id="IEq66"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}^{C\times H\times W \times H \times W}$$\end{document}</tex-math><mml:math id="M124"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq66.gif"/></alternatives></inline-formula> , where <italic>C</italic> is the number of channels, and <italic>H</italic>,&#x000a0;<italic>W</italic> are the height and width, respectively. This module does not have any trainable parameters.</p><p id="Par23">4D convolutions are applied on the set of multi-scale hypercorrelation volumes. This module, adapted from<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, applies the 4D convolutions on center-pivot pixels to reduce the memory and time requirements. Incrementally, lower scale features are upsampled and concatenated with higher scale features, followed by average pooling on the last two dimensions in order to reduce the dimensions of the concatenated correlations <inline-formula id="IEq67"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {C}}_{cls}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {C}}_{sem}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq68.gif"/></alternatives></inline-formula> to <inline-formula id="IEq69"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}^{C\times H\times W}$$\end{document}</tex-math><mml:math id="M130"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq69.gif"/></alternatives></inline-formula>.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathscr {C}}_{cls}&#x00026;= AvgPool\left( Conv^{4D}\left( HV\left( f_{S_{1}}^{cls}, f_{Q}^{cls}\right) \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathscr {C}}_{sem}&#x00026;= AvgPool\left( Conv^{4D}\left( HV\left( f_{S_{1}}^{sem}, f_{Q}^{sem}\right) \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>The first pass concludes with two decoders <inline-formula id="IEq70"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Dec_{1}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq70.gif"/></alternatives></inline-formula> and <inline-formula id="IEq71"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Dec_{2}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq71.gif"/></alternatives></inline-formula>. <inline-formula id="IEq72"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Dec_{1}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq72.gif"/></alternatives></inline-formula> operates on <inline-formula id="IEq73"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {C}}_{cls}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {C}}_{sem}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq74.gif"/></alternatives></inline-formula> and for each generates a semantic segmentation mask of the foreground <inline-formula id="IEq75"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{i}$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq75.gif"/></alternatives></inline-formula> and background <inline-formula id="IEq76"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG_{i}$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq76.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq77"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{cls, sem\}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq77.gif"/></alternatives></inline-formula>, supervised with the losses <inline-formula id="IEq78"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{cls} = \frac{1}{N} \sum _{n=1}^{N} CE\left( BG_{cls} \oplus FG_{cls}, Q^{gt}_{n}\right)$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq78.gif"/></alternatives></inline-formula> and <inline-formula id="IEq79"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{sem} = \frac{1}{N} \sum _{n=1}^{N} CE\left( BG_{sem} \oplus FG_{sem}, Q^{gt}_{n}\right)$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq79.gif"/></alternatives></inline-formula>, respectively, where <inline-formula id="IEq80"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q^{gt}_{n}$$\end{document}</tex-math><mml:math id="M156"><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq80.gif"/></alternatives></inline-formula> is the <italic>n</italic>-th ground-truth query foreground mask, <inline-formula id="IEq81"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \in N$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq81.gif"/></alternatives></inline-formula>. <inline-formula id="IEq82"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Dec_{2}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq82.gif"/></alternatives></inline-formula> transforms the concatenated correlations into <inline-formula id="IEq83"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG_{Q}^{1}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG_{Q}^{1}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq84.gif"/></alternatives></inline-formula>, supervised by loss <inline-formula id="IEq85"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{combined}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">combined</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq85.gif"/></alternatives></inline-formula>.<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG_{cls}, BG_{cls} = Dec_{1}\left( {\mathscr {C}}_{cls}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG_{sem}, BG_{sem} = Dec_{1}\left( {\mathscr {C}}_{sem}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG_{Q}^{1}, BG_{Q}^{1} = Dec_{2}\left( {\mathscr {C}}_{cls} \oplus {\mathscr {C}}_{sem}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02295;</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where the superscript <inline-formula id="IEq86"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(.)^{1}$$\end{document}</tex-math><mml:math id="M174"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq86.gif"/></alternatives></inline-formula> indicates an outcome of the first pass. The loss is given by <inline-formula id="IEq87"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{combined} = \frac{1}{N} \sum _{n=1}^{N} \left[ CE\left( BG_{Q}^{1} \oplus FG_{Q}^{1}, Q^{gt}_{n}\right) - \kappa {\mathscr {L}}_{Sh}\right]$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">combined</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">Sh</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq87.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq88"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa =0.1$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>&#x003ba;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq88.gif"/></alternatives></inline-formula>. The second term of <inline-formula id="IEq89"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{combined}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">combined</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq89.gif"/></alternatives></inline-formula> is the transductive loss term given by Shannon entropy <inline-formula id="IEq90"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{Sh}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">Sh</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq90.gif"/></alternatives></inline-formula>,<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathscr {L}}_{Sh} = \frac{1}{H\times W} \sum _{p=1}^{H\times W} \left( BG_{Q}^{1}(p) \oplus FG_{Q}^{1}(p)\right) log\left( BG_{Q}^{1}(p) \oplus FG_{Q}^{1}(p)\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M184" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">Sh</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in H\times W$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq91.gif"/></alternatives></inline-formula> is pixel. The Shannon entropy encourages the network to have a polarised initial prediction with a high or low confidence area<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, which reduces the number of false positives. The impact of transductive terms is explained further in the appendix.</p></sec><sec id="Sec5"><title>Learning intra-object similarity <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q \rightarrow Q$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq92.gif"/></alternatives></inline-formula></title><p id="Par24">As input for the second pass, the query image <italic>Q</italic> serves as both the support <inline-formula id="IEq93"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}=Q$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq93.gif"/></alternatives></inline-formula> and query <italic>Q</italic>. The objective of the second pass is to learn intra-object similarity by propagating in the query image <italic>Q</italic> those features in <italic>Q</italic> that were visually similar to the features of the support <inline-formula id="IEq94"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq94.gif"/></alternatives></inline-formula> in the first pass. As mentioned previously, the premise is twofold: (i) that intra-object similarity, which is the visual similarity between features in the same image, is greater than intra-class similarity, which is the visual similarity between features in two different images of the same class, and (ii) that learning features of the background and base classes reduces false positives. It has been demonstrated that the affinity between unlabeled samples has a significant effect on transductive learning<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We observed that a pretrained semantic segmentation backbone has greater pixel affinity than a pretrained classification network. In the second pass, we therefore employ a semantic segmentation backbone.</p><p id="Par25">Features <inline-formula id="IEq95"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{2}}^{2}$$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq95.gif"/></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{Q}^{2}$$\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq96.gif"/></alternatives></inline-formula> are extracted by the semantic segmentation backbone <inline-formula id="IEq97"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq97.gif"/></alternatives></inline-formula>. Support features <inline-formula id="IEq98"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{S_{2}}^{2}$$\end{document}</tex-math><mml:math id="M200"><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq98.gif"/></alternatives></inline-formula> are multiplied by the foreground mask of <italic>Q</italic> resulting from the first pass. Similar to the first pass, multi-scale hypercorrelation volumes are calculated followed by multi-scale 4D convolutions and average pooling on the last two dimensions. A decoder <inline-formula id="IEq99"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Dec_{1}$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq99.gif"/></alternatives></inline-formula> maps the correlations <inline-formula id="IEq100"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {C}}^{2}$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq100.gif"/></alternatives></inline-formula> into <inline-formula id="IEq101"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG^{2}$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG^{2}$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>B</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq102.gif"/></alternatives></inline-formula> segmentation maps which are supervised with the loss <inline-formula id="IEq103"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{selfsim} = \frac{1}{N} \sum _{n=1}^{N} CE\left( FG^{2} \oplus BG^{2}, Q^{gt}_{n}\right)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">selfsim</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x02295;</mml:mo><mml:mi>B</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq103.gif"/></alternatives></inline-formula>. Each segmentation is then passed through 1D-convolutions sharing weights (shown as <inline-graphic xlink:href="41598_2024_54640_Figf_HTML.gif" id="d32e2676"/> in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>).<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;f_{S_{2}}^{2} = FG^{1}_{Q} \otimes B_{sem}(S_{2}), f_{Q}^{2} = B_{sem}(Q) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&#x02297;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;{\mathscr {C}}^{2} = AvgPool\left( Conv^{4D}\left( HV\left( f_{S_{2}}^{2}, f_{Q}^{2}\right) \right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mi>H</mml:mi><mml:mi>V</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG^2, BG^2 = Dec_{1}\left( {\mathscr {C}}^{2}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M216" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where the superscript <inline-formula id="IEq104"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(.)^{2}$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>.</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq104.gif"/></alternatives></inline-formula> indicates an outcome of the second pass.<fig id="Fig3"><label>Figure 3</label><caption><p>Technical overview of proposed meta-learner. <inline-formula id="IEq38"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq38.gif"/></alternatives></inline-formula>, <inline-formula id="IEq39"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq39.gif"/></alternatives></inline-formula>: pretrained classification and semantic segmentation networks, respectively (frozen), <inline-formula id="IEq40"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{Cls}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq40.gif"/></alternatives></inline-formula>: pretrained classification layer (frozen), <bold>HV</bold>: Hypercorrelation volumes (multi-scale cosine similarity between features with no trainable parameters), <bold>4D Convs</bold>: 4D convolutions resulting in correlation tensors in <inline-formula id="IEq41"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}^{C\times H\times W \times H \times W}$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq41.gif"/></alternatives></inline-formula> for feature tensors with dimensions <inline-formula id="IEq42"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C\times H\times W$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq42.gif"/></alternatives></inline-formula>, followed by concatenation across scale and an average pooling on the last two dimensions to reduce the dimensions to <inline-formula id="IEq43"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}^{C\times H\times W}$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>H</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-graphic xlink:href="41598_2024_54640_Figd_HTML.gif" id="d32e2954"/>, <inline-graphic xlink:href="41598_2024_54640_Fige_HTML.gif" id="d32e2957"/>: 1D Convolution; the first two <inline-formula id="IEq44"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Conv^{1D}_{a}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq44.gif"/></alternatives></inline-formula> share weights, <bold>BG/FG</bold>: Background/Foreground, <bold>Dec</bold>: a decoder; Decoders shown in yellow are the same. Red indicates a frozen module, Orange indicates shared trainable parameters, and Green indicates a module with individually trainable parameters. Total number of trainable parameters: 2.98<italic>M</italic>.</p></caption><graphic xlink:href="41598_2024_54640_Fig3_HTML" id="MO4"/></fig></p><p id="Par26">The semantic segmentation backbone <inline-formula id="IEq105"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq105.gif"/></alternatives></inline-formula>, which has been pretrained on background and base classes, serves to eliminate false positives from the query foreground segmentation mask. A pretrained classification layer <inline-formula id="IEq106"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{cls}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq106.gif"/></alternatives></inline-formula> acting on the backbone&#x02019;s <inline-formula id="IEq107"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq107.gif"/></alternatives></inline-formula> query features <inline-formula id="IEq108"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( f_{Q}^{sem}\right) ^{1}$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq108.gif"/></alternatives></inline-formula> from the first pass, generates foreground <inline-formula id="IEq109"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG^{1}_{Cls}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq109.gif"/></alternatives></inline-formula> and background <inline-formula id="IEq110"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG^{1}_{Cls}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq110.gif"/></alternatives></inline-formula> maps. The foreground map <inline-formula id="IEq111"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG^{1}_{Cls}$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq111.gif"/></alternatives></inline-formula> of the classifier contains base classes. In the penultimate step, the background map of <inline-formula id="IEq112"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq112.gif"/></alternatives></inline-formula>, <inline-formula id="IEq113"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BG^{2}$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>B</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq113.gif"/></alternatives></inline-formula>, is combined with the foreground map of the classifier <inline-formula id="IEq114"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FB^{1}_{Cls}$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq114.gif"/></alternatives></inline-formula>, passed through a 1D convolution and finally combined with the foreground probabilities of <inline-formula id="IEq115"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq115.gif"/></alternatives></inline-formula>, <inline-formula id="IEq116"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FG^{2}$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq116.gif"/></alternatives></inline-formula>. The final map is supervised with loss <inline-formula id="IEq117"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathscr {L}}_{final} = \frac{1}{N} \sum _{n=1}^{N} CE\left( FG_{F}^{2} \oplus BG_{F}^{2}, Q^{gt}_{n}\right)$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mi mathvariant="italic">final</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02295;</mml:mo><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">gt</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq117.gif"/></alternatives></inline-formula>.<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG^{1}_{Cls}, BG^{1}_{Cls} = H_{cls}\left( \left( f_{Q}^{sem}\right) ^{1}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M260" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msup><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mn>1</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;FG_{F}^{2} = Conv^{1D}_{a}\left( Conv^{1D}_{b}\left( BG^{2}\right) \oplus FG^{1}_{Cls}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>B</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>&#x02295;</mml:mo><mml:mi>F</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cls</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;BG_{F}^{2} = Conv^{1D}_{b}\left( FG^{2}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M264" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>B</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>F</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>The proposed meta-learner (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>) is trained using episodic training supervised by the loss <italic>L</italic> given by,<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L = L_{cls} + L_{sem} + L_{combined} + L_{selfsim} + L_{final} \end{aligned}$$\end{document}</tex-math><mml:math id="M266" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">combined</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">selfsim</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">final</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2024_54640_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>with equal weights for each term.</p><sec id="Sec100"><title>Extension to <italic>K</italic>-shot setting</title><p id="Par27">For <italic>K</italic>-shot setting, we employ the method in<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Given <italic>K</italic> support image-mask pairs and a query image, we perform K forward passes to predict <italic>K</italic> masks. Voting is conducted at each pixel location by summing the <italic>K</italic> predictions and dividing each output score by the maximum votes. A pixel is designated as foreground if its voting score exceeds a predetermined threshold.</p></sec></sec></sec><sec id="Sec6"><title>Experiments</title><sec id="Sec7"><title>Implementation details</title><sec id="Sec101"><title>Modules</title><p id="Par28"> The backbones <inline-formula id="IEq118"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq119.gif"/></alternatives></inline-formula> are frozen Resnet-style backbones pretrained using supervized classification leanirng on ImageNet-1K and supervized segmentation learning on base classes of each fold respectively. The 4D convolutions all share the same architecture and weights, and have 2.5<italic>M</italic> trainable parameters. There are two decoders having the same architecture. We use episodic training to train the meta-learner with the two frozen backbones <inline-formula id="IEq120"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq121.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec102"><title>Training</title><p id="Par29"> The training consists of two phases: pretraining and meta-training. Following<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, we trained a supervised segmentation model on base classes associated with each fold in the first phase. PSPNet with two different backbones, namely ResNet50 and ResNet101, is used as a segmentation model, and it is trained on Pascal-<inline-formula id="IEq122"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M276"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq122.gif"/></alternatives></inline-formula> for 100 epochs and COCO-<inline-formula id="IEq123"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M278"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq123.gif"/></alternatives></inline-formula> for 20 epochs, with batch size set to 12 and a stochastic gradient descent optimizer with an initial learning rate <inline-formula id="IEq124"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.5e-3$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mn>2.5</mml:mn><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq124.gif"/></alternatives></inline-formula>. In the second phase, the entire model with frozen backbones is trained with episodic learning. In the majority of previous FSS methods, it has been demonstrated that frozen backbone facilitate generalisation in episodic learning. For the Pascal-<inline-formula id="IEq125"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M282"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq125.gif"/></alternatives></inline-formula> and COCO-<inline-formula id="IEq126"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M284"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq126.gif"/></alternatives></inline-formula>, the batch size is set to 24 and 48, respectively, and the model is trained for 200 iterations using the Adam optimizer and an initial learning rate of <inline-formula id="IEq127"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1e-3$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mn>1</mml:mn><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq127.gif"/></alternatives></inline-formula>. No data augmentation is used during training to ensure a fair comparison with other methods. Four NVIDIA V100 GPUs are employed for training.</p></sec></sec><sec id="Sec8"><title>Evaluation</title><sec id="Sec103"><title>Benchmark datasets</title><p id="Par30">We evaluate the performance of the proposed method on two major few-shot segmentation datasets, Pascal-<inline-formula id="IEq130"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M288"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq130.gif"/></alternatives></inline-formula> and COCO-<inline-formula id="IEq131"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M290"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq131.gif"/></alternatives></inline-formula>, which were constructed from PASCAL VOC 2012 with 20 classes and MS-COCO datasets with 80 classes, respectively. COCO-<inline-formula id="IEq132"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M292"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq132.gif"/></alternatives></inline-formula> is more challenging because it has more classes, samples, and more object instances per image. With minor modifications to the class partitioning, these two well-known benchmark datasets for semantic segmentation can be utilized to perform few-shot semantic segmentation. Both datasets are partitioned into four folds, with three-quarters of the classes serving as training data (base/seen classes) and the remaining classes serving as validation data (novel/unseen classes). For validation purposes, 1000 episodes of support and query images are sampled from the validation set during the inference phase.</p></sec><sec id="Sec104"><title>Measures</title><p id="Par31"> Results are reported using mean intersection-over-union (mIoU) on individual folds, as well as the average of mIoUs across all folds for both datasets.</p></sec><sec id="Sec105"><title>Results</title><p id="Par32"> Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> shows the quantitative evaluation on the four folds of the Pascal-<inline-formula id="IEq133"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M294"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq133.gif"/></alternatives></inline-formula> dataset. All measures are reported according to their original publications. The highest values are displayed in bold and the second-highest appear underlined. We use Min et al.<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> as a baseline since it has similar architecture to ours and similar number of trainable parameters. Following the few-shot semantic segmentation literature, we focus our comparisons on methods reporting on the two backbones Resnet-50 and Resnet-101. For the purposes of a fair comparison, values that differ less than <inline-formula id="IEq134"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.35\%$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mn>0.35</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq134.gif"/></alternatives></inline-formula> are considered equivalent. Except for Shi et al.<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, which is included in the comparisons, recent transformer-based methods on few-shot semantic segmentation cannot be integrated with convolutional backbones and are thus excluded because the performance boost is attributed to the change in architecture rather than the methodology<sup><xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. A clear example of this is<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> which without the Swin-B tranformer backbone the authors report a drop by <inline-formula id="IEq135"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\%$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq135.gif"/></alternatives></inline-formula> in the mIoU. Our argument is also supported by the experiments reported by the authors in<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> where they demonstrate that our baseline<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> when used with a Swin-B backbone gains an average boost of about <inline-formula id="IEq136"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$6\%$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mn>6</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq136.gif"/></alternatives></inline-formula> on mIoU for COCO-<inline-formula id="IEq137"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M302"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq137.gif"/></alternatives></inline-formula> 1-shot and 5-shot tasks.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison with current state-of-the-art for Pascal-<inline-formula id="IEq128"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M304"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq128.gif"/></alternatives></inline-formula> 1-shot and 5-shot tasks.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Backbone</th><th align="left" rowspan="2">Method</th><th align="left" colspan="5">1-shot</th><th align="left" colspan="5"> 5-shot</th></tr><tr><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th></tr></thead><tbody><tr><td align="left" rowspan="10">Resnet-50</td><td align="left">REPRI<sup><xref ref-type="bibr" rid="CR24">24</xref></sup></td><td char="." align="char">60.2</td><td char="." align="char">67.0</td><td char="." align="char">61.7</td><td char="." align="char">47.5</td><td char="." align="char">59.1</td><td char="." align="char">64.5</td><td char="." align="char">70.8</td><td char="." align="char">71.7</td><td char="." align="char">60.3</td><td char="." align="char">66.8</td></tr><tr><td align="left">PFENet<sup><xref ref-type="bibr" rid="CR4">4</xref></sup></td><td char="." align="char">61.7</td><td char="." align="char">69.5</td><td char="." align="char">55.4</td><td char="." align="char">56.3</td><td char="." align="char">60.8</td><td char="." align="char">63.1</td><td char="." align="char">70.7</td><td char="." align="char">55.8</td><td char="." align="char">57.9</td><td char="." align="char">61.9</td></tr><tr><td align="left">ProtRel<sup><xref ref-type="bibr" rid="CR5">5</xref></sup></td><td char="." align="char">65.2</td><td char="." align="char">72.9</td><td char="." align="char">63.3</td><td char="." align="char">61.3</td><td char="." align="char">65.7</td><td char="." align="char">70.2</td><td char="." align="char">75.6</td><td char="." align="char">68.9</td><td char="." align="char">66.2</td><td char="." align="char">70.2</td></tr><tr><td align="left">VAT<sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td><td char="." align="char">67.6</td><td char="." align="char">72.0</td><td char="." align="char">62.3</td><td char="." align="char">60.1</td><td char="." align="char">65.5</td><td char="." align="char">72.4</td><td char="." align="char">73.6</td><td char="." align="char">68.6</td><td char="." align="char">65.7</td><td char="." align="char">70.1</td></tr><tr><td align="left">SSP<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td><td char="." align="char">60.5</td><td char="." align="char">67.8</td><td char="." align="char">66.4</td><td char="." align="char">51.0</td><td char="." align="char">61.4</td><td char="." align="char">67.5</td><td char="." align="char">72.3</td><td char="." align="char">75.2</td><td char="." align="char">62.1</td><td char="." align="char">69.3</td></tr><tr><td align="left">DCAMA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td><td char="." align="char">67.5</td><td char="." align="char">72.3</td><td char="." align="char">59.6</td><td char="." align="char">59.0</td><td char="." align="char">64.6</td><td char="." align="char">70.5</td><td char="." align="char">73.9</td><td char="." align="char">63.7</td><td char="." align="char">65.8</td><td char="." align="char">68.5</td></tr><tr><td align="left">BAM + SVF<sup><xref ref-type="bibr" rid="CR9">9</xref></sup></td><td char="." align="char"><bold>69</bold>.<bold>38</bold></td><td char="." align="char"><bold>74</bold>.<bold>51</bold></td><td char="." align="char"><bold>68</bold>.<bold>80</bold></td><td char="." align="char"><underline>63.09</underline></td><td char="." align="char"><bold>68</bold>.<bold>95</bold></td><td char="." align="char"><bold>72</bold>.<bold>05</bold></td><td char="." align="char"><bold>76</bold>.<bold>17</bold></td><td char="." align="char"><bold>71</bold>.<bold>97</bold></td><td char="." align="char"><bold>68</bold>.<bold>91</bold></td><td char="." align="char"><bold>72</bold>.<bold>28</bold></td></tr><tr><td align="left">BAM<sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td><td char="." align="char"><underline>68.97</underline></td><td char="." align="char">73.59</td><td char="." align="char"><underline>67.55</underline></td><td char="." align="char">61.13</td><td char="." align="char"><underline>67.81</underline></td><td char="." align="char">70.59</td><td char="." align="char"><underline>75.05</underline></td><td char="." align="char"><underline>70.79</underline></td><td char="." align="char">67.20</td><td char="." align="char"><underline>70.91</underline></td></tr><tr><td align="left">Baseline-HSNet</td><td char="." align="char">64.3</td><td char="." align="char">70.7</td><td char="." align="char">60.3</td><td char="." align="char">60.5</td><td char="." align="char">64.0</td><td char="." align="char">70.3</td><td char="." align="char">73.2</td><td char="." align="char">67.4</td><td char="." align="char">67.1</td><td char="." align="char">69.5</td></tr><tr><td align="left">Ours</td><td char="." align="char">68.03</td><td char="." align="char"><underline>73.69</underline></td><td char="." align="char">64.25</td><td char="." align="char"><bold>64</bold>.<bold>72</bold></td><td char="." align="char"><bold><italic><underline>67.67</underline></italic></bold></td><td char="." align="char"><underline>71.26</underline></td><td char="." align="char"><underline>75.13</underline></td><td char="." align="char">67.75</td><td char="." align="char"><underline>68.11</underline></td><td char="." align="char"><bold><italic><underline>70.56</underline></italic></bold></td></tr><tr><td align="left" rowspan="9">Resnet-101</td><td align="left">REPRI<sup><xref ref-type="bibr" rid="CR24">24</xref></sup></td><td char="." align="char">59.6</td><td char="." align="char">68.6</td><td char="." align="char">62.2</td><td char="." align="char">47.2</td><td char="." align="char">59.4</td><td char="." align="char">66.2</td><td char="." align="char">71.4</td><td char="." align="char">67.0</td><td char="." align="char">57.7</td><td char="." align="char">65.6</td></tr><tr><td align="left">PPNet<sup><xref ref-type="bibr" rid="CR14">14</xref></sup></td><td char="." align="char">52.7</td><td char="." align="char">62.8</td><td char="." align="char">57.4</td><td char="." align="char">47.7</td><td char="." align="char">55.2</td><td char="." align="char">60.3</td><td char="." align="char">70.0</td><td char="." align="char">69.4</td><td char="." align="char">60.7</td><td char="." align="char">65.1</td></tr><tr><td align="left">PFENet<sup><xref ref-type="bibr" rid="CR4">4</xref></sup></td><td char="." align="char">60.5</td><td char="." align="char">69.4</td><td char="." align="char">54.4</td><td char="." align="char">55.9</td><td char="." align="char">60.1</td><td char="." align="char">62.8</td><td char="." align="char">70.4</td><td char="." align="char">54.9</td><td char="." align="char">57.6</td><td char="." align="char">61.4</td></tr><tr><td align="left">ProtRel<sup><xref ref-type="bibr" rid="CR5">5</xref></sup></td><td char="." align="char">67.8</td><td char="." align="char"><underline>74.6</underline></td><td char="." align="char"><underline>65.7</underline></td><td char="." align="char">62.2</td><td char="." align="char">67.5</td><td char="." align="char">70.0</td><td char="." align="char"><underline>75.9</underline></td><td char="." align="char"><bold>71</bold>.<bold>8</bold></td><td char="." align="char">65.8</td><td char="." align="char">70.9</td></tr><tr><td align="left">VAT<sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td><td char="." align="char"><underline>70.0</underline></td><td char="." align="char">72.5</td><td char="." align="char">64.8</td><td char="." align="char"><underline>64.2</underline></td><td char="." align="char"><underline>67.9</underline></td><td char="." align="char"><bold>75</bold>.<bold>0</bold></td><td char="." align="char">75.2</td><td char="." align="char">68.4</td><td char="." align="char"><underline>69.5</underline></td><td char="." align="char"><underline>72.0</underline></td></tr><tr><td align="left">SSP<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td><td char="." align="char">60.5</td><td char="." align="char">67.8</td><td char="." align="char">66.4</td><td char="." align="char">51.0</td><td char="." align="char">61.4</td><td char="." align="char">67.5</td><td char="." align="char">72.3</td><td char="." align="char">75.2</td><td char="." align="char">62.1</td><td char="." align="char">69.3</td></tr><tr><td align="left">DCAMA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td><td char="." align="char">65.4</td><td char="." align="char">71.4</td><td char="." align="char">63.2</td><td char="." align="char">58.3</td><td char="." align="char">64.6</td><td char="." align="char">70.7</td><td char="." align="char">73.7</td><td char="." align="char">66.8</td><td char="." align="char">61.9</td><td char="." align="char">68.3</td></tr><tr><td align="left">Baseline-HSNet</td><td char="." align="char">67.3</td><td char="." align="char">72.3</td><td char="." align="char">62.0</td><td char="." align="char">63.1</td><td char="." align="char">66.2</td><td char="." align="char">71.8</td><td char="." align="char">74.4</td><td char="." align="char">67.0</td><td char="." align="char">68.3</td><td char="." align="char">70.4</td></tr><tr><td align="left">Ours</td><td char="." align="char"><bold>71</bold>.<bold>25</bold></td><td char="." align="char"><bold>76</bold>.<bold>19</bold></td><td char="." align="char"><bold>67</bold>.<bold>73</bold></td><td char="." align="char"><bold>66</bold>.<bold>47</bold></td><td char="." align="char"><bold><italic><underline>70.41</underline></italic></bold></td><td char="." align="char"><underline>73.85</underline></td><td char="." align="char"><bold>77</bold>.<bold>53</bold></td><td char="." align="char"><underline>70.72</underline></td><td char="." align="char"><bold>70</bold>.<bold>41</bold></td><td char="." align="char"><bold><italic><underline>73.12</underline></italic></bold></td></tr></tbody></table><table-wrap-foot><p> The highest values are in bold, and the second-highest are underlined. Average mIoU is bold italic. See appendix for full-sized table.</p></table-wrap-foot></table-wrap></p><p id="Par33">With a Resnet-101 backbone, our method is state-of-the-art for both 1-shot and 5-shot. It exceeds the baseline<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> by <inline-formula id="IEq138"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4.21\%$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mn>4.21</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq138.gif"/></alternatives></inline-formula> on 1-shot and <inline-formula id="IEq139"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.72\%$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mn>2.72</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq139.gif"/></alternatives></inline-formula> on 5-shot task. Additionally, its margins for the 1-shot and 5-shot are <inline-formula id="IEq140"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.51\%$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mn>2.51</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq140.gif"/></alternatives></inline-formula> and <inline-formula id="IEq141"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.12\%$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mn>1.12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq141.gif"/></alternatives></inline-formula>, compared to the second-best performing methods. With a Resnet-50 backbone, we achieve results comparable to other methods with similar number of trainable parameters. The most recent work of Sun et al.<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, which achieves state-of-the-art with a Resnet-50, significantly increases the memory requirements because, according to the authors, it requires 128<italic>G</italic> for a batch 8 (16<italic>G</italic> for one image), which is significantly higher than any other few-shot semantic segmentation technique.</p><p id="Par34">The quantitative evaluation of the four folds of the COCO-<inline-formula id="IEq142"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M314"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq142.gif"/></alternatives></inline-formula> data set is displayed in the Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>. We achieve state-of-the-art for COCO-<inline-formula id="IEq143"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M316"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq143.gif"/></alternatives></inline-formula> with Resnet-101 backbone for both 1-shot and 5-shot. It exceeds the baseline<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> by <inline-formula id="IEq144"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9.68\%$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mn>9.68</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq144.gif"/></alternatives></inline-formula> on 1-shot and by <inline-formula id="IEq145"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.40\%$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mn>5.40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq145.gif"/></alternatives></inline-formula> on 5-shot. In addition, it has a margin of <inline-formula id="IEq146"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.98\%$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mn>3.98</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq146.gif"/></alternatives></inline-formula> and <inline-formula id="IEq147"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6\%$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq147.gif"/></alternatives></inline-formula> over the second-best performing strategy. Using a Resnet-50 backbone, we achieve second-best performance by a margin of <inline-formula id="IEq148"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.35\%$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:mn>0.35</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq148.gif"/></alternatives></inline-formula> on 1-shot and <inline-formula id="IEq149"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.12\%$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mn>1.12</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq149.gif"/></alternatives></inline-formula> compared to the significantly more memory-intensive method of Sun et al.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison with current state-of-the-art for COCO-<inline-formula id="IEq129"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M330"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq129.gif"/></alternatives></inline-formula> 1-shot and 5-shot tasks.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Backbone</th><th align="left" rowspan="2">Method</th><th align="left" colspan="5">1-shot</th><th align="left" colspan="5">5-shot</th></tr><tr><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th></tr></thead><tbody><tr><td align="left" rowspan="10">Resnet-50</td><td align="left">REPRI<sup><xref ref-type="bibr" rid="CR24">24</xref></sup></td><td char="." align="char">32.0</td><td char="." align="char">38.7</td><td char="." align="char">32.7</td><td char="." align="char">33.1</td><td char="." align="char">34.1</td><td char="." align="char">39.3</td><td char="." align="char">45.4</td><td char="." align="char">39.7</td><td char="." align="char">41.8</td><td char="." align="char">41.6</td></tr><tr><td align="left">PFENet<sup><xref ref-type="bibr" rid="CR4">4</xref></sup></td><td char="." align="char">36.5</td><td char="." align="char">38.6</td><td char="." align="char">34.5</td><td char="." align="char">33.8</td><td char="." align="char">35.8</td><td char="." align="char">36.5</td><td char="." align="char">43.3</td><td char="." align="char">37.8</td><td char="." align="char">38.4</td><td char="." align="char">39.0</td></tr><tr><td align="left">ProtRel<sup><xref ref-type="bibr" rid="CR5">5</xref></sup></td><td char="." align="char">42.2</td><td char="." align="char">48.9</td><td char="." align="char">45.5</td><td char="." align="char">44.6</td><td char="." align="char">45.3</td><td char="." align="char">48.0</td><td char="." align="char">55.7</td><td char="." align="char">50.7</td><td char="." align="char">50.1</td><td char="." align="char">51.1</td></tr><tr><td align="left">VAT<sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td><td char="." align="char">39.0</td><td char="." align="char">43.8</td><td char="." align="char">42.6</td><td char="." align="char">39.7</td><td char="." align="char">41.3</td><td char="." align="char">44.1</td><td char="." align="char">51.1</td><td char="." align="char">50.2</td><td char="." align="char">46.1</td><td char="." align="char">47.9</td></tr><tr><td align="left">SSP<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td><td char="." align="char">35.5</td><td char="." align="char">39.6</td><td char="." align="char">37.9</td><td char="." align="char">36.7</td><td char="." align="char">37.4</td><td char="." align="char">40.6</td><td char="." align="char">47.0</td><td char="." align="char">45.1</td><td char="." align="char">43.9</td><td char="." align="char">44.1</td></tr><tr><td align="left">DCAMA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td><td char="." align="char">41.9</td><td char="." align="char">45.1</td><td char="." align="char">44.4</td><td char="." align="char">41.7</td><td char="." align="char">43.3</td><td char="." align="char">45.9</td><td char="." align="char">50.5</td><td char="." align="char">50.7</td><td char="." align="char">46.0</td><td char="." align="char">48.3</td></tr><tr><td align="left">BAM + SVF<sup><xref ref-type="bibr" rid="CR9">9</xref></sup></td><td char="." align="char"><bold> 46.87</bold></td><td char="." align="char"><bold>53</bold>.<bold>80</bold></td><td char="." align="char"><underline>48.43</underline></td><td char="." align="char"><underline> 44.78</underline></td><td char="." align="char"><bold>48</bold>.<bold>47</bold></td><td char="." align="char"><bold>52</bold>.<bold>25</bold></td><td char="." align="char"><underline>57.83</underline></td><td char="." align="char"><underline>51.97</underline></td><td char="." align="char"><bold>53</bold>.<bold>41</bold></td><td char="." align="char"><bold>53</bold>.<bold>87</bold></td></tr><tr><td align="left">BAM<sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td><td char="." align="char"><underline>43.41</underline></td><td char="." align="char">50.59</td><td char="." align="char">47.49</td><td char="." align="char">43.42</td><td char="." align="char"><underline>46.23</underline></td><td char="." align="char"><underline>49.26</underline></td><td char="." align="char">54.20</td><td char="." align="char"><underline>51.63</underline></td><td char="." align="char">49.55</td><td char="." align="char">51.16</td></tr><tr><td align="left">Baseline-HSNet</td><td char="." align="char">36.3</td><td char="." align="char">43.1</td><td char="." align="char">38.7</td><td char="." align="char">39.2</td><td char="." align="char">39.2</td><td char="." align="char">43.3</td><td char="." align="char">51.3</td><td char="." align="char">48.2</td><td char="." align="char">45.0</td><td char="." align="char">46.9</td></tr><tr><td align="left">Ours</td><td char="." align="char">42.15</td><td char="." align="char"><underline>53.22</underline></td><td char="." align="char"><bold>49</bold>.<bold>05</bold></td><td char="." align="char"><bold>48</bold>.<bold>08</bold></td><td char="." align="char"><bold><italic>48.12</italic></bold></td><td char="." align="char">47.50</td><td char="." align="char"><bold>59</bold>.<bold>14</bold></td><td char="." align="char"><bold>53</bold>.<bold>19</bold></td><td char="." align="char"><underline>51.16</underline></td><td char="." align="char"><bold><italic><underline>52.75</underline></italic></bold></td></tr><tr><td align="left" rowspan="7">Resnet-101</td><td align="left">PPNet<sup><xref ref-type="bibr" rid="CR14">14</xref></sup></td><td char="." align="char">17.0</td><td char="." align="char">18.0</td><td char="." align="char">21.0</td><td char="." align="char">28.9</td><td char="." align="char">21.2</td><td char="." align="char">19.1</td><td char="." align="char">21.5</td><td char="." align="char">23.9</td><td char="." align="char">30.1</td><td char="." align="char">23.7</td></tr><tr><td align="left">PFENet<sup><xref ref-type="bibr" rid="CR4">4</xref></sup></td><td char="." align="char">34.3</td><td char="." align="char">33.0</td><td char="." align="char">32.3</td><td char="." align="char">30.1</td><td char="." align="char">32.4</td><td char="." align="char">38.5</td><td char="." align="char">38.6</td><td char="." align="char">38.2</td><td char="." align="char">34.3</td><td char="." align="char">27.4</td></tr><tr><td align="left">ProtRel<sup><xref ref-type="bibr" rid="CR5">5</xref></sup></td><td char="." align="char">42.9</td><td char="." align="char"><underline>50.6</underline></td><td char="." align="char"><underline>46.8</underline></td><td char="." align="char">47.4</td><td char="." align="char">46.9</td><td char="." align="char">50.7</td><td char="." align="char"><underline>58.3</underline></td><td char="." align="char"><bold>52</bold>.<bold>8</bold></td><td char="." align="char"><underline>51.3</underline></td><td char="." align="char"><underline>53.3</underline></td></tr><tr><td align="left">SSP<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td><td char="." align="char">39.1</td><td char="." align="char">45.1</td><td char="." align="char">42.7</td><td char="." align="char">41.2</td><td char="." align="char">42.0</td><td char="." align="char">47.4</td><td char="." align="char">54.5</td><td char="." align="char">50.4</td><td char="." align="char">49.6</td><td char="." align="char">50.2</td></tr><tr><td align="left">DCAMA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td><td char="." align="char">41.5</td><td char="." align="char">46.2</td><td char="." align="char">45.2</td><td char="." align="char">41.3</td><td char="." align="char">43.5</td><td char="." align="char">48.0</td><td char="." align="char">58.0</td><td char="." align="char">54.3</td><td char="." align="char">47.1</td><td char="." align="char">51.9</td></tr><tr><td align="left">Baseline-HSNet</td><td char="." align="char">37.2</td><td char="." align="char">44.1</td><td char="." align="char">42.4</td><td char="." align="char">41.3</td><td char="." align="char">41.2</td><td char="." align="char">45.9</td><td char="." align="char">53.0</td><td char="." align="char">51.8</td><td char="." align="char">47.1</td><td char="." align="char">49.5</td></tr><tr><td align="left">Ours</td><td char="." align="char"><bold>45</bold>.<bold>48</bold></td><td char="." align="char"><bold>56</bold>.<bold>47</bold></td><td char="." align="char"><bold>51</bold>.<bold>74</bold></td><td char="." align="char"><bold>49</bold>.<bold>84</bold></td><td char="." align="char"><bold><italic>50.88</italic></bold></td><td char="." align="char"><underline>48.87</underline></td><td char="." align="char"><bold>61</bold>.<bold>10</bold></td><td char="." align="char"><underline>55.58</underline></td><td char="." align="char"><bold>54</bold>.<bold>03</bold></td><td char="." align="char"><bold><italic>54.90</italic></bold></td></tr></tbody></table><table-wrap-foot><p>The highest values are in bold, and the second-highest are underlined. Average mIoU is bold italic. See appendix for full-sized table.</p></table-wrap-foot></table-wrap></p><p id="Par35">Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref> displays qualitative comparisons using a Resnet-50 backbone. The first and second columns represent the support and query images, while the remaining columns represent the results of SSP<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, HSNET<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, DCAMA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, BAM<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, and ours (last column). As can be seen, our method can successfully handle challenging cases in which the object in the support differs visually from the object in the query and the visual similarity between the foreground and background is high, as in the second and fourth rows.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Qualitative results. The first and second columns show the support and query images, respectively, overlaid with the ground truth in red. The remaining columns show the predictions overlaid with a red.</p></caption><graphic position="anchor" xlink:href="41598_2024_54640_Tab4_HTML" id="MO5"/></table-wrap></p></sec></sec><sec id="Sec9"><title>Ablations</title><p id="Par36">Our method results in a substantial performance increase. We demonstrate this by applying it to the classification-based method of Min et al.<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. In the subsequent experiments, we use this as a baseline and conduct 32 experiments consisting of a baseline with a classification backbone (with <inline-formula id="IEq150"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq150.gif"/></alternatives></inline-formula>), a baseline with a segmentation backbone (with <inline-formula id="IEq151"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq151.gif"/></alternatives></inline-formula>), a baseline with dual backbones (with <inline-formula id="IEq152"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq152.gif"/></alternatives></inline-formula> + <inline-formula id="IEq153"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq153.gif"/></alternatives></inline-formula>), and a two-pass dual backbone baseline (two-pass with <inline-formula id="IEq154"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq154.gif"/></alternatives></inline-formula> + <inline-formula id="IEq155"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq155.gif"/></alternatives></inline-formula>). For each ablation, we use Resnet-50 and Resnet-101 backbones, and conduct experiments on all folds of Pascal-<inline-formula id="IEq156"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M344"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq156.gif"/></alternatives></inline-formula> for 1-shot and 5-shot. The models are trained for 200 epochs with batch of 12 and Adam optimizer with an initial learning rate of <inline-formula id="IEq157"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1e-3$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:mn>1</mml:mn><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq157.gif"/></alternatives></inline-formula>.</p><p id="Par37">We begin with an experiment in which the classification backbone used by the baseline<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> is replaced with a semantic segmentation network in order to gain a better understanding of the impact that the type of the backbone can have on the performance. The first (Baseline) and second (with <inline-formula id="IEq169"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq169.gif"/></alternatives></inline-formula>) rows of each table cell display the results for the 1-shot and 5-shot Pascal-<inline-formula id="IEq170"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M350"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq170.gif"/></alternatives></inline-formula> tasks, respectively. Using a classification backbone for Resnet-50 is preferable to using a semantic segmentation backbone. The opposite is true for Resnet-101, and this is supported by the outcomes of both 1-shot and 5-shot tasks. As shown in the third row (with <inline-formula id="IEq171"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq171.gif"/></alternatives></inline-formula> + <inline-formula id="IEq172"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq172.gif"/></alternatives></inline-formula>), it is evident that using both types of backbone improves performance, which is supported by the results on both tasks. As explained in the introduction, this is due to the fact that the <inline-formula id="IEq173"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq174.gif"/></alternatives></inline-formula> backbones capture diverse but distinct visual features. The fourth row (two-pass with <inline-formula id="IEq175"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq175.gif"/></alternatives></inline-formula> +<inline-formula id="IEq176"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq176.gif"/></alternatives></inline-formula>) displays the results of applying our method to the baseline which increases performance by <inline-formula id="IEq177"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.64\%$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:mn>3.64</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq177.gif"/></alternatives></inline-formula> and <inline-formula id="IEq178"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.88\%$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:mn>3.88</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq178.gif"/></alternatives></inline-formula> for the 1-shot task with Resnet-50 and Resnet-101 backbones, respectively, and a performance increase of <inline-formula id="IEq179"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.6\%$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mn>1.6</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq179.gif"/></alternatives></inline-formula> and <inline-formula id="IEq180"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.16\%$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:mn>2.16</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq180.gif"/></alternatives></inline-formula> for 5-shot for Resnet-50 and Resnet-101, respectively as shown in Table&#x000a0;<xref rid="Tab5" ref-type="table">5</xref>. For additional experiments we refer the reader to the &#x0201c;<xref rid="MOESM1" ref-type="media">Supplementary Information</xref>&#x0201d;.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Ablations on all components of our method.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Backbone</th><th align="left" rowspan="2">Method</th><th align="left" colspan="5">1-shot</th><th align="left" colspan="5">5-shot</th></tr><tr><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th><th align="left">f0</th><th align="left">f1</th><th align="left">f2</th><th align="left">f3</th><th align="left">mIoU</th></tr></thead><tbody><tr><td align="left" rowspan="4">Resnet-50</td><td align="left">Baseline - HSNET</td><td char="." align="char">62.80</td><td char="." align="char">70.09</td><td char="." align="char">60.16</td><td char="." align="char">58.98</td><td char="." align="char">63.01</td><td char="." align="char">69.12</td><td char="." align="char">73.67</td><td char="." align="char">66.21</td><td char="." align="char">65.44</td><td char="." align="char">68.61</td></tr><tr><td align="left">with <inline-formula id="IEq159"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq159.gif"/></alternatives></inline-formula></td><td char="." align="char">60.84</td><td char="." align="char">68.27</td><td char="." align="char">59.70</td><td char="." align="char">59.15</td><td char="." align="char">61.99</td><td char="." align="char">66.85</td><td char="." align="char">72.91</td><td char="." align="char">66.55</td><td char="." align="char">66.02</td><td char="." align="char">68.09</td></tr><tr><td align="left">with <inline-formula id="IEq160"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq160.gif"/></alternatives></inline-formula> + <inline-formula id="IEq161"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq161.gif"/></alternatives></inline-formula></td><td char="." align="char">64.87</td><td char="." align="char">71.79</td><td char="." align="char">64.12</td><td char="." align="char">60.97</td><td char="." align="char">65.44</td><td char="." align="char">70.11</td><td char="." align="char">74.48</td><td char="." align="char">67.51</td><td char="." align="char">67.09</td><td char="." align="char">69.79</td></tr><tr><td align="left">two-pass with <inline-formula id="IEq162"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq162.gif"/></alternatives></inline-formula> + <inline-formula id="IEq163"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq163.gif"/></alternatives></inline-formula></td><td char="." align="char"><bold>66</bold>.<bold>26</bold></td><td char="." align="char"><bold>73</bold>.<bold>76</bold></td><td char="." align="char"><bold>63</bold>.<bold>22</bold></td><td char="." align="char"><bold>63</bold>.<bold>37</bold></td><td char="." align="char"><bold><italic>66.65</italic></bold></td><td char="." align="char"><bold>70</bold>.<bold>55</bold></td><td char="." align="char"><bold>75</bold>.<bold>22</bold></td><td char="." align="char"><bold>67</bold>.<bold>05</bold></td><td char="." align="char"><bold>68</bold>.<bold>02</bold></td><td char="." align="char"><bold><italic>70.21</italic></bold></td></tr><tr><td align="left" rowspan="4">Resnet-101</td><td align="left">Baseline - HSNET</td><td char="." align="char">66.41</td><td char="." align="char">71.51</td><td char="." align="char">62.30</td><td char="." align="char">61.96</td><td char="." align="char">65.55</td><td char="." align="char">71.45</td><td char="." align="char">75.07</td><td char="." align="char">67.10</td><td char="." align="char">67.60</td><td char="." align="char">70.30</td></tr><tr><td align="left">with <inline-formula id="IEq164"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq164.gif"/></alternatives></inline-formula></td><td char="." align="char">65.70</td><td char="." align="char">72.72</td><td char="." align="char">64.01</td><td char="." align="char">62.21</td><td char="." align="char">66.16</td><td char="." align="char">71.16</td><td char="." align="char">75.94</td><td char="." align="char">69.41</td><td char="." align="char">68.03</td><td char="." align="char">71.14</td></tr><tr><td align="left">with <inline-formula id="IEq165"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq165.gif"/></alternatives></inline-formula> + <inline-formula id="IEq166"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq166.gif"/></alternatives></inline-formula></td><td char="." align="char">68.47</td><td char="." align="char">74.02</td><td char="." align="char">64.74</td><td char="." align="char">63.59</td><td char="." align="char">67.71</td><td char="." align="char">72.19</td><td char="." align="char">76.85</td><td char="." align="char">69.76</td><td char="." align="char">69.21</td><td char="." align="char">72.00</td></tr><tr><td align="left">two-pass with <inline-formula id="IEq167"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{cls}$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">cls</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq167.gif"/></alternatives></inline-formula> + <inline-formula id="IEq168"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{sem}$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">sem</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq168.gif"/></alternatives></inline-formula></td><td char="." align="char"><bold>69</bold>.<bold>22</bold></td><td char="." align="char"><bold>74</bold>.<bold>49</bold></td><td char="." align="char">
<bold>67</bold>.<bold>20</bold></td><td char="." align="char"><bold>66</bold>.<bold>81</bold></td><td char="." align="char"><bold><italic>69.43</italic></bold></td><td char="." align="char"><bold>73</bold>.<bold>28</bold></td><td char="." align="char"><bold>77</bold>.<bold>01</bold></td><td char="." align="char"><bold>69</bold>.<bold>94</bold></td><td char="." align="char"><bold>69</bold>.<bold>64</bold></td><td char="." align="char"><bold><italic>72.46</italic></bold></td></tr></tbody></table><table-wrap-foot><p>Experiments reported for Pascal-<inline-formula id="IEq158"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M392"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq158.gif"/></alternatives></inline-formula> with Resnet-50 and Resnet-101 backbones. The highest values are displayed in bold and average mIoU is bold italic.</p></table-wrap-foot></table-wrap></p></sec></sec><sec id="Sec10"><title>Conclusion</title><p id="Par38">In conclusion, we proposed a novel two-pass end-to-end method for few-shot semantic segmentation that addresses three key problems affecting performance. The approach leverages an ensemble of visual features learned from pretrained classification and semantic segmentation networks with the same architecture to capture rich and diverse information at different depths. Additionally, the pretrained semantic segmentation network serves as a base class extractor to reduce false positives. The first pass addresses intra-class similarity by matching support foreground features to query features, and the second pass leverages intra-object similarity by learning to suppress false positives and propagating query foreground features. Experimental results on benchmark datasets demonstrate significant improvement in performance with minimal trainable parameters. Specifically, using Resnet-101, the proposed method achieves state-of-the-art performance for both 1-shot and 5-shot Pascal-<inline-formula id="IEq181"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{i}$$\end{document}</tex-math><mml:math id="M394"><mml:msup><mml:mn>5</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq181.gif"/></alternatives></inline-formula>, as well as on 1-shot and 5-shot COCO-<inline-formula id="IEq182"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$20^{i}$$\end{document}</tex-math><mml:math id="M396"><mml:msup><mml:mn>20</mml:mn><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="41598_2024_54640_Article_IEq182.gif"/></alternatives></inline-formula>.</p></sec><sec sec-type="supplementary-material"><sec id="Sec17"><title>Supplementary Information</title><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41598_2024_54640_MOESM1_ESM.pdf"><caption><p>Supplementary Information.</p></caption></media></supplementary-material></p></sec></sec></body><back><fn-group><fn><p><bold>Publisher's note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><sec><title>Supplementary Information</title><p>The online version contains supplementary material available at 10.1038/s41598-024-54640-6.</p></sec><ack><title>Acknowledgements</title><p>This work is financially supported by the Natural Sciences and Engineering Research Council of Canada Grants RGPIN-2021-03479 (NSERC DG) and ALLRP 571887 - 2021 (NSERC Alliance).</p></ack><notes notes-type="author-contribution"><title>Author contributions</title><p>A.K. and C.P. wrote the main manuscript text and A.K. implemented the experiments and analyzed the results. All authors reviewed the manuscript.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>The datasets generated and/or analysed during the current study are available in the PASCAL VOC <ext-link ext-link-type="uri" xlink:href="http://host.robots.ox.ac.uk/pascal/VOC/">http://host.robots.ox.ac.uk/pascal/VOC/</ext-link> and COCO <ext-link ext-link-type="uri" xlink:href="https://cocodataset.org/">https://cocodataset.org/</ext-link> repositories.</p></notes><notes id="FPar1" notes-type="COI-statement"><title>Competing interests</title><p id="Par39">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilal</surname><given-names>A</given-names></name><name><surname>Sun</surname><given-names>G</given-names></name><name><surname>Mazhar</surname><given-names>S</given-names></name><name><surname>Imran</surname><given-names>A</given-names></name><name><surname>Latif</surname><given-names>J</given-names></name></person-group><article-title>A transfer learning and u-net-based automatic detection of diabetic retinopathy from fundus images</article-title><source>Comput. Methods Biomech. Biomed. Eng. Imaging Vis.</source><year>2022</year><volume>10</volume><fpage>663</fpage><lpage>674</lpage><pub-id pub-id-type="doi">10.1080/21681163.2021.2021111</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilal</surname><given-names>A</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Deng</surname><given-names>A</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Wu</surname><given-names>N</given-names></name></person-group><article-title>AI-based automatic detection and classification of diabetic retinopathy using U-Net and deep learning</article-title><source>Symmetry</source><year>2022</year><volume>14</volume><fpage>1427</fpage><pub-id pub-id-type="doi">10.3390/sym14071427</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Li, Z., Kamnitsas, K. &#x00026; Glocker, B. Overfitting of neural nets under class imbalance: Analysis and improvements for segmentation. In <italic>Medical Image Computing and Computer Assisted Intervention&#x02013;MICCAI 2019: 22nd International Conference, Shenzhen, China, October 13&#x02013;17, 2019, Proceedings, Part III 22</italic> 402&#x02013;410 (Springer, 2019).</mixed-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Prior guided feature enrichment network for few-shot segmentation</article-title><source>IEEE TPAMI</source><year>2020</year><volume>44</volume><fpage>1050</fpage><lpage>1065</lpage><pub-id pub-id-type="doi">10.1109/TPAMI.2020.3013717</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Okazawa, A. Interclass prototype relation for few-shot segmentation. In <italic>European Conference on Computer Vision, ECCV</italic> (2022).</mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Hong, S., Cho, S., Nam, J., Lin, S. &#x00026; Kim, S. Cost aggregation with 4d convolutional swin transformer for few-shot segmentation. In <italic>European Conference on Computer Vision, ECCV</italic> (2021).</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Fan, Q., Pei, W., Tai, Y.-W. &#x00026; Tang, C.-K. Self-support few-shot semantic segmentation. In <italic>European Conference on Computer Vision</italic> 701&#x02013;719 (Springer, 2022).</mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Shi, X. <italic>et&#x000a0;al.</italic> Dense cross-query-and-support attention weighted mask aggregation for few-shot segmentation. In <italic>Workshop on Statistical Learning in Computer Vision, ECCV</italic> (2022).</mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Sun, Y. <italic>et&#x000a0;al.</italic> Singular value fine-tuning: Few-shot segmentation requires few-parameters fine-tuning. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2206.06122">arXiv:2206.06122</ext-link> (2022).</mixed-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Lang, C., Cheng, G., Tu, B. &#x00026; Han, J. Learning what not to segment: A new perspective on few-shot segmentation. In <italic>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</italic> 8057&#x02013;8067 (2022).</mixed-citation></ref><ref id="CR11"><label>11.</label><mixed-citation publication-type="other">Wang, K., Liew, J.&#x000a0;H., Zou, Y., Zhou, D. &#x00026; Feng, J. Panet: Few-shot image semantic segmentation with prototype alignment. In <italic>Proceedings of the IEEE International Conference on Computer Vision</italic> 9197&#x02013;9206 (2019).</mixed-citation></ref><ref id="CR12"><label>12.</label><mixed-citation publication-type="other">Zhang, C., Lin, G., Liu, F., Yao, R. &#x00026; Shen, C. Canet: Class-agnostic segmentation networks with iterative refinement and attentive few-shot learning. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 5217&#x02013;5226 (2019).</mixed-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname><given-names>H</given-names></name><name><surname>Wei</surname><given-names>D</given-names></name><name><surname>Ma</surname><given-names>K</given-names></name><name><surname>Gu</surname><given-names>S</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name></person-group><article-title>A unified framework for generalized low-shot medical image segmentation with scarce data</article-title><source>IEEE Trans. Med. Imaging</source><year>2021</year><volume>40</volume><fpage>2656</fpage><lpage>2671</lpage><pub-id pub-id-type="doi">10.1109/TMI.2020.3045775</pub-id><?supplied-pmid 33338014?><pub-id pub-id-type="pmid">33338014</pub-id>
</element-citation></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">Liu, Y., Zhang, X., Zhang, S. &#x00026; He, X. Part-aware prototype network for few-shot semantic segmentation. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2007.06309">arXiv:2007.06309</ext-link> (2020).</mixed-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Yang, B., Liu, C., Li, B., Jiao, J. &#x00026; Ye, Q. Prototype mixture models for few-shot semantic segmentation. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2008.03898">arXiv:2008.03898</ext-link> (2020).</mixed-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Zhang, B., Xiao, J. &#x00026; Qin, T. Self-guided and cross-guided learning for few-shot segmentation. In <italic>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</italic> (2021).</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Chen, W.-Y., Liu, Z.&#x000a0;K., Frank&#x000a0;Wang, Y. &#x00026; Huang, J.-B. A closer look at few-shot classification. In <italic>ICLR</italic> (2019).</mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">Dhillon, G.&#x000a0;S., Chaudhari, P., Ravichandran, A. &#x00026; Soatto, S. A baseline for fewshot image classification. In <italic>ICLR</italic> (2019).</mixed-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Guo, Y. <italic>et&#x000a0;al.</italic> A broader study of cross-domain few-shot learning. In <italic>European Conference on Computer Vision (ECCV)</italic> (2020).</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Tian, Y., Wang, Y., Krishnan, D., Tenenbaum, J. B. &#x00026; Isola, P. Rethinking few-shot image classification: A good embedding is all you need?. In <italic>European Conference on Computer Vision (ECCV)</italic> (2020).</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Masud&#x000a0;Ziko, I., Dolz, J., Granger, E. &#x00026; Ben&#x000a0;Ayed, I. Laplacian regularized few-shot learning. In <italic>International Conference on Machine Learning (ICML)</italic> (2020).</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Liu, Y., Lee, J. &#x00026; Park, M. Learning to propagate labels: Transductive propagation network for few-shot learning. In <italic>International Conference on Learning Representations(ICLR 2019)</italic> (2019).</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Rodr&#x00131;guez, P., Laradji, I., Drouin, A. &#x00026; Lacoste, A. Embedding propagation: Smoother manifold for few-shot classification. In <italic>European Conference on Computer Vision, ECCV</italic> (2020).</mixed-citation></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="other">Boudiaf, M., Kervadec, H., Imtiaz&#x000a0;Masud, Z. &#x00026; Piantanida, P. Few-shot segmentation without meta-learning: A good transductive inference is all you need?. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> (2021).</mixed-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Zeiler, M.&#x000a0;D. &#x00026; Fergus, R. Visualizing and understanding convolutional networks. In <italic>Computer Vision&#x02013;ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6&#x02013;12, 2014, Proceedings, Part I 13</italic> 818&#x02013;833 (Springer, 2014).</mixed-citation></ref><ref id="CR26"><label>26.</label><mixed-citation publication-type="other">Long, J., Shelhamer, E. &#x00026; Darrell, T. Fully convolutional networks for semantic segmentation. In <italic>Proceedings of the IEEE conference on computer vision and pattern recognition</italic> 3431&#x02013;3440 (2015).</mixed-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Noh, H., Hong, S. &#x00026; Han, B. Learning deconvolution network for semantic segmentation. In <italic>Proceedings of the IEEE international conference on computer vision</italic> 1520&#x02013;1528 (2015).</mixed-citation></ref><ref id="CR28"><label>28.</label><mixed-citation publication-type="other">Badrinarayanan, V., Handa, A. &#x00026; Cipolla, R. Segnet: A deep convolutional encoder-decoder architecture for robust semantic pixel-wise labelling. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1505.07293">arXiv:1505.07293</ext-link> (2015).</mixed-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="other">Min, J., Kang, D. &#x00026; Cho, M. Hypercorrelation squeeze for few-shot segmentation. In <italic>Proceedings of the IEEE/CVF International Conference on Computer Vision</italic> 6941&#x02013;6952 (2021).</mixed-citation></ref><ref id="CR30"><label>30.</label><mixed-citation publication-type="other">Vinyals, O., Blundell, C., Lillicrap, T., Wierstra, D. <italic>et&#x000a0;al.</italic> Matching networks for one shot learning. In <italic>Advances in neural information processing systems</italic> 3630&#x02013;3638 (2016).</mixed-citation></ref><ref id="CR31"><label>31.</label><mixed-citation publication-type="other">Satorras, V.&#x000a0;G. &#x00026; Estrach, J.&#x000a0;B. Few-shot learning with graph neural networks. In <italic>Intl. Conf. on Learning Representations</italic> (2018).</mixed-citation></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="other">Gidaris, S. &#x00026; Komodakis, N. Dynamic few-shot visual learning without forgetting. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 4367&#x02013;4375 (2018).</mixed-citation></ref><ref id="CR33"><label>33.</label><mixed-citation publication-type="other">Hu, T. <italic>et al.</italic> Attention-based multi-context guiding for few-shot semantic segmentation. In <italic>Proceedings of the AAAI Conference on Artificial Intelligence</italic> Vol. 33, 8441&#x02013;8448 (2019).</mixed-citation></ref><ref id="CR34"><label>34.</label><mixed-citation publication-type="other">Ravi, S. &#x00026; Larochelle, H. Optimization as a model for few-shot learning. In <italic>ICLR 2017</italic> (2016).</mixed-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Rusu, A.&#x000a0;A. <italic>et&#x000a0;al.</italic> Meta-learning with latent embedding optimization. In <italic>International Conference on Learning Representations</italic> (2018).</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Sung, F. <italic>et&#x000a0;al.</italic> Learning to compare: Relation network for few-shot learning. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 1199&#x02013;1208 (2018).</mixed-citation></ref><ref id="CR37"><label>37.</label><mixed-citation publication-type="other">Snell, J., Swersky, K. &#x00026; Zemel, R. Prototypical networks for few-shot learning. In <italic>Advances in Neural Information Processing Systems</italic> 4077&#x02013;4087 (2017).</mixed-citation></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="other">Finn, C., Abbeel, P. &#x00026; Levine, S. Model-agnostic meta-learning for fast adaptation of deep networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1703.03400">arXiv:1703.03400</ext-link> (2017).</mixed-citation></ref><ref id="CR39"><label>39.</label><mixed-citation publication-type="other">Rakelly, K., Shelhamer, E., Darrell, T., Efros, A. &#x00026; Levine, S. Conditional networks for few-shot semantic segmentation. In <italic>ICLR Workshop track</italic> (2018).</mixed-citation></ref><ref id="CR40"><label>40.</label><mixed-citation publication-type="other">Rakelly, K., Shelhamer, E., Darrell, T., Efros, A.&#x000a0;A. &#x00026; Levine, S. Few-shot segmentation propagation with guided networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1806.07373">arXiv:1806.07373</ext-link> (2018).</mixed-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">Liu, W., Zhang, C., Lin, G. &#x00026; Liu, F. Crnet: Cross-reference networks for few-shot segmentation. In <italic>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</italic> 4165&#x02013;4173 (2020).</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Hariharan, B. &#x00026; Girshick, R. Low-shot visual recognition by shrinking and hallucinating features. In <italic>Proceedings of the IEEE International Conference on Computer Vision</italic> 3018&#x02013;3027 (2017).</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Wang, Y.-X., Girshick, R., Hebert, M. &#x00026; Hariharan, B. Low-shot learning from imaginary data. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 7278&#x02013;7286 (2018).</mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">Bucher, M., Tuan-Hung, V., Cord, M. &#x00026; P&#x000e9;rez, P. Zero-shot semantic segmentation. In <italic>Advances in Neural Information Processing Systems</italic> 468&#x02013;479 (2019).</mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="other">Li, A., Luo, T., Lu, Z., Xiang, T. &#x00026; Wang, L. Large-scale few-shot learning: Knowledge transfer with class hierarchy. In <italic>Proceedings of the IEEE Conf. on Computer Vision and Pattern Recognition</italic> 7212&#x02013;7220 (2019).</mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="other">Schwartz, E., Karlinsky, L., Feris, R., Giryes, R. &#x00026; Bronstein, A.&#x000a0;M. Baby steps towards few-shot learning with multiple semantics. In <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition Workshop</italic> (2019).</mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Teed, Z. &#x00026; Deng, J. Raft: Recurrent all-pairs field transforms for optical flow. In <italic>European Conference on Computer Vision</italic> 402&#x02013;419 (Springer, 2020).</mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="other">Zhang, J., Sun, Y., Yang, Y. &#x00026; Chen, W. Feature-proxy transformer for few-shot segmentation. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/2210.06908">arXiv:abs/2210.06908</ext-link> (2022).</mixed-citation></ref><ref id="CR49"><label>49.</label><mixed-citation publication-type="other">S.&#x000a0;Dhillon, G., Chaudhari, P. &#x00026; Ravichandran, A. A baseline for few-shot image classification. In <italic>International Conference on Learning Representations (ICLR 2020)</italic> (2020).</mixed-citation></ref><ref id="CR50"><label>50.</label><mixed-citation publication-type="other">Sun, G., Liu, Y., Liang, J. &#x00026; Van&#x000a0;Gool, L. Boosting few-shot semantic segmentation with transformers. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2108.02266">arXiv:2108.02266</ext-link> (2021).</mixed-citation></ref></ref-list></back></article>